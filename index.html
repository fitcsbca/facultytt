<!DOCTYPE html>
<html>
<head>
  <title>Faculty Timetable</title>
  <style>
    .current {
      background: #d1ffd1;
      padding: 5px;
      border-left: 5px solid green;
    }
  </style>
</head>
<body>

<h2>Faculty Timetable</h2>

<label>Date:</label>
<input type="date" id="date">

<label>Class:</label>
<select id="class">
  <option value="ClassA">Class A</option>
</select>

<label>Faculty:</label>
<input type="text" id="faculty" placeholder="Dr. Sharma">

<button onclick="showTimetable()">Show</button>

<div id="output"></div>

  <script>

    // Auto set today's date
document.getElementById("date").valueAsDate = new Date();

async function showTimetable() {
  const date = document.getElementById("date").value;
  const className = document.getElementById("class").value;
  const facultyName = document.getElementById("faculty").value.trim();
  const now = new Date();

  const day = new Date(date).toLocaleDateString("en-US", {
    weekday: "long"
  });

  const currentTime = now.toTimeString().slice(0, 5);

  const res = await fetch("timetable.json");
  const data = await res.json();

  const lectures = data[className]?.[day];

  if (!lectures) {
    document.getElementById("output").innerHTML = "No timetable found";
    return;
  }

  let html = `<h3>${className} - ${day}</h3>`;

  lectures.forEach(l => {
    if (facultyName && l.faculty !== facultyName) return;

    const isCurrent =
      currentTime >= l.start && currentTime <= l.end;

    html += `
      <div class="${isCurrent ? "current" : ""}">
        <b>${l.start} - ${l.end}</b><br>
        ${l.subject}<br>
        Faculty: ${l.faculty}
        ${isCurrent ? "<b> (ONGOING)</b>" : ""}
      </div><br>
    `;
  });

  document.getElementById("output").innerHTML = html || "No lectures";
}

  </script>
</body>
</html>
